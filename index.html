<!Doctype html>
<html>
    <head>
        <title>Diplomacy</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <meta charset = "UTF-8">
        <style>
            body 
            {
                margin: 0;
                padding: 0;
                overflow: hidden;
                background-color: 0;
            }
        </style>
        <script src = "konva.min.js"></script>
    </head>
    <body>
        <div id = "container"></div>
        <script src = 'render/loadassets.js'></script>
        <script src = 'render/layers.js'></script>
        <script src = 'render/rgbtohex.js'></script>
        <script src = 'options/gameCoords.js'></script>
        
        <script src = 'interface/entityinterface.js'></script>
        <script src = 'interface/towninterface.js'></script>
        
        <script src = 'sprites/sprite.js'></script>
        <script src = 'groups/spritesGroup.js'></script>
        
        <script src = 'sprites/empty.js'></script>
        <script src = 'sprites/text.js'></script>
        <script src = 'sprites/button.js'></script>
        
        <script src = 'events.js'></script>
        
        <script src = 'sprites/hexagon.js'></script>
        <script src = 'groups/grid.js'></script>
        
        <script src = 'sprites/entities/entity.js'></script>
        <script src = 'sprites/entities/buildings/building.js'></script>
        <script src = 'sprites/entities/units/unit.js'></script>
        
        <script src = 'sprites/entities/buildings/town.js'></script>
        <script src = 'sprites/entities/units/noob.js'></script>
        
        <script src = 'player.js'></script>
        <script>
        'use strict'
        
        let stage = new Konva.Stage(
        {
            container: 'container',
            width: width,
            height: height
        })
        
        Konva.pixelRatio = 1

            
        let layers = new Layers(['grid', 'coordGrid', 'entity', 'selectUnit', 'entityInterface', 'townInterface', 'gameMenu'])
        
        let grid = new Grid(0, 0, new SpritesGroup(0, 0))
        
        players.push(new Empty, new Player({r: 255, g: 0, b: 0}))
            
        loadAssets()
        
        let selected = false
                                                                                                                                                    
        layers.grid.add(grid.createObject())
        layers.grid.listening(true)
        layers.townInterface.listening(true)
        layers.gameMenu.listening(true)
        layers.coordGrid.add(grid.coordGrid.createObject())
        
        let nextTurnButton = new Konva.Image({
            x: width - height * 0.12,
            y: height - height * 0.12,
            image: assets['nextTurnButton'],
            width: height * 0.1,
            height: height * 0.1
        }) 
        layers.gameMenu.add(nextTurnButton)
        nextTurnButton.on('click', click)

        grid.fill(20, 10)
            
        let town = new Town(5, 2, 100, 1)
        
        let unit = new Noob(2, 2, 10, 1) 
        
        let whooseTurn = 1
        
        let entityInterface = new EntityInterface()
        let townInterface = new TownInterface()
        
        layers.entityInterface.add(...entityInterface.createObject())
        layers.townInterface.add(...townInterface.createObject()) 
            
        
        window.addEventListener('load', function() {
            layers.entity.add(town.createObject())
            layers.entity.add(unit.createObject())
            layers.entity.draw()
        })          
        stage.setX(basis.offset.x)
        stage.setY(basis.offset.y * 2)  
        entityInterface.move(-basis.offset.x, -basis.offset.y * 2)
        townInterface.move(-basis.offset.x, -basis.offset.y * 2)
        layers.gameMenu.setX(-basis.offset.x)
        layers.gameMenu.setY(-basis.offset.y * 2)
            
        layers.addToStage()
        town.paintCommuterville()
        </script>
    </body>
</html>